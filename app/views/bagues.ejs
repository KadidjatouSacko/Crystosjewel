<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'Bagues - Ã‰clat DorÃ©' %></title>
    <link rel="stylesheet" href="/css/bijoux.css">
    <link rel="stylesheet" href="/css/bagues.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --rose-gold: #b76e79;
            --rose-gold-light: #e8c2c8;
            --rose-gold-dark: #7d4b53;
            --cream: #fff8f0;
            --dark-text: #3a3a3a;
            --light-text: #666;
            --border-light: #e0e0e0;
            --white-soft: #fafafa;
            --shadow-soft: 0 4px 15px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        /* ================================
           BANNIÃˆRES PROMOTIONNELLES UNIFORMES
           ================================ */
        .promo-banner, .secondary-banner {
            color: white;
            text-align: center;
            padding: 12px 0; /* MÃªme hauteur pour toutes les banniÃ¨res */
            font-weight: 600;
            font-size: 14px; /* MÃªme taille de police */
            position: relative;
            overflow: hidden;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 45px; /* Hauteur fixe uniforme */
        }

        .promo-banner {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            animation: pulse 2s infinite;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.3);
        }
        
        .secondary-banner {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .promo-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 3s infinite;
        }
        
        .promo-text, .secondary-text {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* ================================
           BADGES PRODUITS DYNAMIQUES
           ================================ */
        .product-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 12px;
            font-weight: 700;
            z-index: 5;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: badgeAppear 0.5s ease-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes badgeAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* Styles de badges dynamiques */
        .product-badge.promo, .product-badge.solde {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            animation: pulse 2s infinite, badgeAppear 0.5s ease-out;
            font-size: 13px;
            padding: 9px 18px;
        }
        
        .product-badge.nouveau {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .product-badge.bestseller, .product-badge.populaire {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            position: relative;
        }
        
        .product-badge.bestseller::before, .product-badge.populaire::before {
            content: 'ðŸ”¥';
            margin-right: 6px;
        }

        .product-badge.derniere-chance {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            animation: urgentPulse 1.5s infinite;
        }

        @keyframes urgentPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* ================================
           SYSTÃˆME DE FILTRES FONCTIONNEL
           ================================ */
        .filter-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-soft);
        }

        .filter-section {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .filter-dropdown {
            position: relative;
        }

        .filter-btn, .sort-btn {
            background: linear-gradient(135deg, var(--rose-gold-light), white);
            border: 2px solid var(--rose-gold-light);
            padding: 12px 24px;
            font-size: 14px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--rose-gold-dark);
        }

        .filter-btn:hover, .sort-btn:hover {
            border-color: var(--rose-gold);
            background: linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(183, 110, 121, 0.3);
        }

        .filter-options, .sort-options {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 25px;
            min-width: 300px;
            z-index: 100;
            display: none;
            border: 1px solid var(--border-light);
        }

        .filter-options.active, .sort-options.active {
            display: block;
            animation: filterSlideIn 0.3s ease-out;
        }

        @keyframes filterSlideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .filter-group {
            margin-bottom: 25px;
        }

        .filter-group h4 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--rose-gold);
            font-weight: 700;
            border-bottom: 2px solid var(--rose-gold-light);
            padding-bottom: 8px;
        }

        .filter-group label {
            display: flex;
            align-items: center;
            font-size: 14px;
            margin-bottom: 12px;
            cursor: pointer;
            color: var(--dark-text);
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .filter-group label:hover {
            background: var(--rose-gold-light);
            color: var(--rose-gold-dark);
        }

        .filter-group input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
            accent-color: var(--rose-gold);
        }

        .apply-filters-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark));
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .apply-filters-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(183, 110, 121, 0.4);
        }

        .sort-option {
            display: block;
            padding: 12px 15px;
            text-decoration: none;
            color: var(--dark-text);
            font-size: 14px;
            border-radius: 8px;
            transition: all 0.3s ease;
            margin-bottom: 5px;
        }

        .sort-option:hover, .sort-option.active {
            background: var(--rose-gold-light);
            color: var(--rose-gold-dark);
            transform: translateX(5px);
        }

        /* ================================
           GRILLE RESPONSIVE - 2 PRODUITS SUR MOBILE
           ================================ */
        .products-grid {
            display: grid;
            gap: 30px;
            margin-bottom: 50px;
        }

        /* Desktop : 3 colonnes */
        @media (min-width: 992px) {
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Tablettes : 2 colonnes */
        @media (min-width: 769px) and (max-width: 991px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Mobile : 2 colonnes comme demandÃ© */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
        }

        /* ================================
           CARTES PRODUITS SANS FAVORIS
           ================================ */
        .product-card {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            transition: all 0.4s ease;
            position: relative;
            border: 1px solid var(--border-light);
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
            border-color: var(--rose-gold-light);
        }

        .product-img {
            width: 100%;
            height: 280px;
            overflow: hidden;
            background: linear-gradient(135deg, var(--cream), var(--white-soft));
            position: relative;
        }

        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            transition: transform 0.4s ease;
        }

        .product-card:hover .product-img img {
            transform: scale(1.05);
        }

        .placeholder-image {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--rose-gold-light), var(--cream));
            color: var(--rose-gold);
            font-size: 3rem;
        }

        .product-info {
            padding: 25px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .product-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark-text);
            line-height: 1.4;
        }

        .product-desc {
            font-size: 0.9rem;
            color: var(--light-text);
            margin-bottom: 20px;
            flex-grow: 1;
            line-height: 1.6;
        }

        /* SystÃ¨me de prix avec rÃ©ductions */
        .product-price-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .price-current {
            font-size: 1.4rem;
            font-weight: 700;
            color: #e74c3c;
        }
        
        .price-original {
            font-size: 1.1rem;
            color: #7f8c8d;
            text-decoration: line-through;
        }
        
        .price-single {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--rose-gold);
        }

        /* Actions produits SANS favoris */
        .product-actions {
            display: flex;
            gap: 12px;
        }

        .product-btn {
            flex: 1;
            padding: 15px 20px;
            background: linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark));
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .product-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(183, 110, 121, 0.4);
        }

        .view-jewel-btn {
            background: linear-gradient(135deg, #34495e, #2c3e50);
        }

        .view-jewel-btn:hover {
            box-shadow: 0 8px 25px rgba(52, 73, 94, 0.4);
        }

        /* ================================
           PAGINATION AMÃ‰LIORÃ‰E
           ================================ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 50px;
        }

        .page-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--border-light);
            text-decoration: none;
            color: var(--dark-text);
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            background: white;
        }

        .page-link:hover, .page-link.active {
            background: linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark));
            color: white;
            border-color: var(--rose-gold);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(183, 110, 121, 0.3);
        }

        /* ================================
           RESPONSIVE DESIGN
           ================================ */
        @media (max-width: 768px) {
            .promo-banner, .secondary-banner {
                font-size: 12px;
                padding: 10px 0;
                min-height: 40px;
            }
            
            .filter-controls {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
            }
            
            .filter-section {
                width: 100%;
                justify-content: center;
            }
            
            .filter-options, .sort-options {
                min-width: 280px;
                left: 50%;
                transform: translateX(-50%);
            }
            
            .product-badge {
                font-size: 10px;
                padding: 6px 12px;
            }
            
            .product-img {
                height: 200px;
            }
            
            .product-info {
                padding: 20px 15px;
            }
            
            .product-name {
                font-size: 1.1rem;
            }
            
            .product-desc {
                font-size: 0.85rem;
            }
            
            .product-actions {
                flex-direction: column;
            }
            
            .page-link {
                width: 45px;
                height: 45px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .products-grid {
                gap: 15px;
            }
            
            .product-img {
                height: 180px;
            }
            
            .product-btn {
                padding: 12px 15px;
                font-size: 0.8rem;
            }
        }

        /* ================================
           UTILITAIRES
           ================================ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .category-intro {
            padding: 70px 0 40px;
        }

        .intro-content {
            text-align: center;
            max-width: 800px;
            margin: 0 auto 50px;
        }

        .intro-content h3 {
            font-size: 2.2rem;
            color: var(--rose-gold);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .intro-content p {
            font-size: 1.1rem;
            color: var(--dark-text);
            line-height: 1.8;
        }

        .products {
            padding: 40px 0 80px;
        }

        .page-banner {
            background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('/images/bagues-banner.jpg') center/cover;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
        }

        .banner-content h2 {
            font-size: 3.2rem;
            font-weight: 300;
            letter-spacing: 3px;
            margin-bottom: 15px;
        }

        .banner-content p {
            font-size: 1.3rem;
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* Ã‰tat vide */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--light-text);
        }

        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--rose-gold);
        }

        .empty-state p {
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- BanniÃ¨res promotionnelles uniformes -->
    <div class="promo-banner">
        <div class="promo-text">
            <i class="fas fa-fire"></i>
            PROMOTIONS EXCEPTIONNELLES ! Jusqu'Ã  -50% sur une sÃ©lection de bijoux
            <i class="fas fa-fire"></i>
        </div>
    </div>

    <div class="secondary-banner">
        <div class="secondary-text">
            <i class="fas fa-shipping-fast"></i>
            Livraison gratuite dÃ¨s 150â‚¬ d'achat
        </div>
    </div>

    <header>
        <%- include('partials/navbarre.ejs') %>
        <div class="overlay" id="overlay"></div>
    </header>

    <section class="page-banner">
        <div class="banner-content">
            <h2><%= pageTitle || 'Nos Bagues' %></h2>
            <p>Des crÃ©ations dÃ©licates pour sublimer vos mains</p>
        </div>
    </section>

    <section class="category-intro">
        <div class="container">
            <div class="intro-content">
                <h3>L'Ã©lÃ©gance au bout des doigts</h3>
                <p>DÃ©couvrez notre collection de bagues en rose gold et or, ornÃ©es de pierres prÃ©cieuses soigneusement sÃ©lectionnÃ©es. Chaque piÃ¨ce est conÃ§ue pour magnifier votre style et apporter une touche d'Ã©clat Ã  vos tenues quotidiennes ou vos occasions spÃ©ciales.</p>
            </div>
           
            <!-- SystÃ¨me de filtres fonctionnel -->
            <div class="filter-controls">
                <div class="filter-section">
                    <div class="filter-dropdown">
                        <button type="button" class="filter-btn" onclick="toggleFilters()">
                            <i class="fas fa-filter"></i> Filtrer
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="filter-options" id="filterOptions">
                            <form method="GET" action="/bagues">
                                <!-- MatÃ©riau dynamique -->
                                <div class="filter-group">
                                    <h4><i class="fas fa-gem"></i> MatÃ©riau</h4>
                                    <% if (materials && materials.length > 0) { %>
                                        <% materials.forEach(material => { %>
                                            <label>
                                                <input type="checkbox" name="matiere" value="<%= material.id %>"
                                                    <%= (filters.matiere && filters.matiere.includes && filters.matiere.includes(material.id.toString())) ? 'checked' : '' %>>
                                                <%= material.name %>
                                            </label>
                                        <% }); %>
                                    <% } %>
                                </div>

                                <!-- Style/Type dynamique -->
                                <div class="filter-group">
                                    <h4><i class="fas fa-ring"></i> Style</h4>
                                    <% if (types && types.length > 0) { %>
                                        <% types.forEach(type => { %>
                                            <label>
                                                <input type="checkbox" name="type" value="<%= type.id %>"
                                                    <%= (filters.type && filters.type.includes && filters.type.includes(type.id.toString())) ? 'checked' : '' %>>
                                                <%= type.name %>
                                            </label>
                                        <% }); %>
                                    <% } %>
                                </div>

                                <!-- Prix -->
                                <div class="filter-group">
                                    <h4><i class="fas fa-euro-sign"></i> Prix</h4>
                                    <% ['0-100', '100-200', '200-500', '500+'].forEach(range => { %>
                                        <label>
                                            <input type="checkbox" name="prix" value="<%= range %>"
                                                <%= (filters.prix && filters.prix.includes && filters.prix.includes(range)) ? 'checked' : '' %>>
                                            <% if (range === '500+') { %>Plus de 500â‚¬<% } else { %><%= range %> â‚¬<% } %>
                                        </label>
                                    <% }); %>
                                </div>

                                <button type="submit" class="apply-filters-btn">
                                    <i class="fas fa-check"></i> Appliquer les filtres
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-dropdown">
                        <button type="button" class="sort-btn" onclick="toggleSort()">
                            <i class="fas fa-sort"></i> Trier par
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="sort-options" id="sortOptions">
                            <a href="?sort=popularity" class="sort-option <%= filters.sort === 'popularity' ? 'active' : '' %>">
                                <i class="fas fa-fire"></i> PopularitÃ©
                            </a>
                            <a href="?sort=price_asc" class="sort-option <%= filters.sort === 'price_asc' ? 'active' : '' %>">
                                <i class="fas fa-arrow-up"></i> Prix croissant
                            </a>
                            <a href="?sort=price_desc" class="sort-option <%= filters.sort === 'price_desc' ? 'active' : '' %>">
                                <i class="fas fa-arrow-down"></i> Prix dÃ©croissant
                            </a>
                            <a href="?sort=newest" class="sort-option <%= filters.sort === 'newest' || !filters.sort ? 'active' : '' %>">
                                <i class="fas fa-star"></i> NouveautÃ©s
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
        
    <section class="products">
        <div class="container">
            <div class="products-grid">
                <% if (jewels && jewels.length > 0) { %>
                    <% jewels.forEach(jewel => { %>
                        <div class="product-card">
                            <!-- Badge dynamique avec banniÃ¨res -->
                            <% if (jewel.badge) { %>  
                                <div class="product-badge <%= jewel.badgeClass %>"><%= jewel.badge %></div>
                            <% } %>
                            
                            <div class="product-img">
                                <% if (jewel.image && jewel.image !== 'no-image.jpg') { %>
                                    <img src="/uploads/jewels/<%= jewel.image %>" alt="<%= jewel.name %>" 
                                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                    <div class="placeholder-image" style="display: none;">
                                        <i class="fas fa-gem"></i>
                                    </div>
                                <% } else { %>
                                    <div class="placeholder-image">
                                        <i class="fas fa-gem"></i>
                                    </div>
                                <% } %>
                            </div>
                            
                            <div class="product-info">
                                <h3 class="product-name"><%= jewel.name %></h3>
                                <p class="product-desc"><%= jewel.description || 'Magnifique bijou de notre collection' %></p>
                                
                                <!-- Prix avec systÃ¨me de rÃ©duction -->
                                <div class="product-price-container">
                                    <% if (jewel.hasDiscount) { %>
                                        <div class="price-current"><%= jewel.formattedCurrentPrice %></div>
                                        <div class="price-original"><%= jewel.formattedOriginalPrice %></div>
                                    <% } else { %>
                                        <div class="price-single"><%= jewel.formattedCurrentPrice %></div>
                                    <% } %>
                                </div>
                                
                                <!-- Actions SANS systÃ¨me de favoris -->
                                <div class="product-actions">
                                    <button class="product-btn add-to-cart-btn" 
                                            data-jewel-id="<%= jewel.id %>" 
                                            data-jewel-name="<%= jewel.name %>">
                                        <i class="fas fa-shopping-cart"></i> Ajouter au panier
                                    </button>
                                    <a href="/bijoux/<%= jewel.slug %>" class="product-btn view-jewel-btn">
                                        <i class="fas fa-eye"></i> Voir le bijou
                                    </a>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <div class="empty-state">
                        <h3>Aucune bague trouvÃ©e</h3>
                        <p>Essayez de modifier vos critÃ¨res de recherche.</p>
                    </div>
                <% } %>
            </div>
            
            <!-- Pagination dynamique -->
            <% if (pagination && pagination.totalPages > 1) { %>
                <div class="pagination">
                    <% if (pagination.hasPrevPage) { %>
                        <a href="?page=<%= pagination.prevPage %>" class="page-link">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    <% } %>
                    
                    <% for (let i = 1; i <= pagination.totalPages; i++) { %>
                        <% if (i === pagination.currentPage) { %>
                            <span class="page-link active"><%= i %></span>
                        <% } else { %>
                            <a href="?page=<%= i %>" class="page-link"><%= i %></a>
                        <% } %>
                    <% } %>
                    
                    <% if (pagination.hasNextPage) { %>
                        <a href="?page=<%= pagination.nextPage %>" class="page-link">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    <% } %>
                </div>
            <% } %>
        </div>
    </section>

    <!-- Footer -->
    <%- include('partials/footer') %>

    <!-- Scripts JavaScript -->
    <script>
        // ================================
        // FONCTIONS POUR LES FILTRES
        // ================================
        function toggleFilters() {
            const filterOptions = document.getElementById('filterOptions');
            const sortOptions = document.getElementById('sortOptions');
            
            // Fermer le tri si ouvert
            if (sortOptions.classList.contains('active')) {
                sortOptions.classList.remove('active');
            }
            
            // Toggle les filtres
            filterOptions.classList.toggle('active');
        }

        function toggleSort() {
            const filterOptions = document.getElementById('filterOptions');
            const sortOptions = document.getElementById('sortOptions');
            
            // Fermer les filtres si ouverts
            if (filterOptions.classList.contains('active')) {
                filterOptions.classList.remove('active');
            }
            
            // Toggle le tri
            sortOptions.classList.toggle('active');
        }

        // Fermer les dropdowns quand on clique ailleurs
        document.addEventListener('click', function(event) {
            const filterDropdown = event.target.closest('.filter-dropdown');
            const filterOptions = document.getElementById('filterOptions');
            const sortOptions = document.getElementById('sortOptions');
            
            if (!filterDropdown) {
                filterOptions.classList.remove('active');
                sortOptions.classList.remove('active');
            }
        });

        // ================================
        // SYSTÃˆME D'AJOUT AU PANIER
        // ================================
        document.addEventListener('DOMContentLoaded', function() {
            // Gestion des boutons "Ajouter au panier"
            const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
            
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const jewelId = this.getAttribute('data-jewel-id');
                    const jewelName = this.getAttribute('data-jewel-name');
                    
                    // Animation du bouton
                    this.style.transform = 'scale(0.95)';
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ajout...';
                    
                    // Simulation d'ajout au panier
                    setTimeout(() => {
                        addToCart(jewelId, jewelName, this);
                    }, 500);
                });
            });
        });

        function addToCart(jewelId, jewelName, button) {
            // Ici vous pouvez intÃ©grer votre logique d'ajout au panier existante
            fetch('/panier/ajouter', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: JSON.stringify({
                    jewelId: jewelId,
                    quantity: 1
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Animation de succÃ¨s
                    button.style.transform = 'scale(1)';
                    button.innerHTML = '<i class="fas fa-check"></i> AjoutÃ© !';
                    button.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    
                    // Notification de succÃ¨s
                    showNotification(`${jewelName} ajoutÃ© au panier !`, 'success');
                    
                    // Remettre le bouton normal aprÃ¨s 2 secondes
                    setTimeout(() => {
                        button.innerHTML = '<i class="fas fa-shopping-cart"></i> Ajouter au panier';
                        button.style.background = 'linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark))';
                    }, 2000);
                    
                    // Mettre Ã  jour le compteur du panier si prÃ©sent
                    updateCartCounter();
                } else {
                    // Gestion des erreurs
                    button.style.transform = 'scale(1)';
                    button.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erreur';
                    button.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    
                    showNotification(data.message || 'Erreur lors de l\'ajout au panier', 'error');
                    
                    setTimeout(() => {
                        button.innerHTML = '<i class="fas fa-shopping-cart"></i> Ajouter au panier';
                        button.style.background = 'linear-gradient(135deg, var(--rose-gold), var(--rose-gold-dark))';
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                button.style.transform = 'scale(1)';
                button.innerHTML = '<i class="fas fa-shopping-cart"></i> Ajouter au panier';
                showNotification('Erreur de connexion', 'error');
            });
        }

        // ================================
        // SYSTÃˆME DE NOTIFICATIONS
        // ================================
        function showNotification(message, type = 'success') {
            // CrÃ©er la notification
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // Styles de la notification
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                z-index: 9999;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                min-width: 300px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #27ae60, #2ecc71)' : 'linear-gradient(135deg, #e74c3c, #c0392b)'};
            `;
            
            document.body.appendChild(notification);
            
            // Animation d'entrÃ©e
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Animation de sortie et suppression
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // ================================
        // MISE Ã€ JOUR COMPTEUR PANIER
        // ================================
        function updateCartCounter() {
            // Mettre Ã  jour le compteur du panier dans la navigation
            fetch('/panier/count')
                .then(response => response.json())
                .then(data => {
                    const cartCounters = document.querySelectorAll('.cart-count, .cart-counter');
                    cartCounters.forEach(counter => {
                        counter.textContent = data.count || 0;
                        if (data.count > 0) {
                            counter.style.display = 'block';
                        }
                    });
                })
                .catch(error => console.error('Erreur mise Ã  jour compteur:', error));
        }

        // ================================
        // ANIMATIONS ET EFFETS
        // ================================
        
        // Animation des cartes produits au scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observer toutes les cartes produits
        document.addEventListener('DOMContentLoaded', function() {
            const productCards = document.querySelectorAll('.product-card');
            productCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
                observer.observe(card);
            });
        });

        // ================================
        // GESTION RESPONSIVE
        // ================================
        window.addEventListener('resize', function() {
            const filterOptions = document.getElementById('filterOptions');
            const sortOptions = document.getElementById('sortOptions');
            
            // Fermer les dropdowns sur redimensionnement
            if (window.innerWidth <= 768) {
                filterOptions.classList.remove('active');
                sortOptions.classList.remove('active');
            }
        });

        // ================================
        // AMÃ‰LIORATION UX BADGES
        // ================================
        document.addEventListener('DOMContentLoaded', function() {
            // Animation des badges promotionnels
            const promoBadges = document.querySelectorAll('.product-badge.promo');
            promoBadges.forEach(badge => {
                badge.addEventListener('mouseenter', function() {
                    this.style.animation = 'none';
                    setTimeout(() => {
                        this.style.animation = 'pulse 2s infinite, badgeAppear 0.5s ease-out';
                    }, 100);
                });
            });
        });
    </script>

    <!-- Styles additionnels pour les notifications -->
    <style>
        .notification {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification-content i {
            font-size: 1.2rem;
        }
        
        @media (max-width: 768px) {
            .notification {
                right: 10px;
                left: 10px;
                min-width: auto;
                max-width: calc(100% - 20px);
            }
        }
    </style>


<script src="/js/jewelry-manager.js"></script>
</body>
</html>